{"version":3,"file":"use-deep-compare-effect.umd.js","sources":["../node_modules/dequal/dist/index.mjs","../src/index.ts"],"sourcesContent":["var has = Object.prototype.hasOwnProperty;\n\nfunction find(iter, tar, key) {\n\tfor (key of iter.keys()) {\n\t\tif (dequal(key, tar)) return key;\n\t}\n}\n\nexport function dequal(foo, bar) {\n\tvar ctor, len, tmp;\n\tif (foo === bar) return true;\n\n\tif (foo && bar && (ctor=foo.constructor) === bar.constructor) {\n\t\tif (ctor === Date) return foo.getTime() === bar.getTime();\n\t\tif (ctor === RegExp) return foo.toString() === bar.toString();\n\n\t\tif (ctor === Array) {\n\t\t\tif ((len=foo.length) === bar.length) {\n\t\t\t\twhile (len-- && dequal(foo[len], bar[len]));\n\t\t\t}\n\t\t\treturn len === -1;\n\t\t}\n\n\t\tif (ctor === Set) {\n\t\t\tif (foo.size !== bar.size) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tfor (len of foo) {\n\t\t\t\ttmp = len;\n\t\t\t\tif (tmp && typeof tmp === 'object') {\n\t\t\t\t\ttmp = find(bar, tmp);\n\t\t\t\t\tif (!tmp) return false;\n\t\t\t\t}\n\t\t\t\tif (!bar.has(tmp)) return false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tif (ctor === Map) {\n\t\t\tif (foo.size !== bar.size) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tfor (len of foo) {\n\t\t\t\ttmp = len[0];\n\t\t\t\tif (tmp && typeof tmp === 'object') {\n\t\t\t\t\ttmp = find(bar, tmp);\n\t\t\t\t\tif (!tmp) return false;\n\t\t\t\t}\n\t\t\t\tif (!dequal(len[1], bar.get(tmp))) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tif (ctor === ArrayBuffer) {\n\t\t\tfoo = new Uint8Array(foo);\n\t\t\tbar = new Uint8Array(bar);\n\t\t} else if (ctor === DataView) {\n\t\t\tif ((len=foo.byteLength) === bar.byteLength) {\n\t\t\t\twhile (len-- && foo.getInt8(len) === bar.getInt8(len));\n\t\t\t}\n\t\t\treturn len === -1;\n\t\t}\n\n\t\tif (ArrayBuffer.isView(foo)) {\n\t\t\tif ((len=foo.byteLength) === bar.byteLength) {\n\t\t\t\twhile (len-- && foo[len] === bar[len]);\n\t\t\t}\n\t\t\treturn len === -1;\n\t\t}\n\n\t\tif (!ctor || typeof foo === 'object') {\n\t\t\tlen = 0;\n\t\t\tfor (ctor in foo) {\n\t\t\t\tif (has.call(foo, ctor) && ++len && !has.call(bar, ctor)) return false;\n\t\t\t\tif (!(ctor in bar) || !dequal(foo[ctor], bar[ctor])) return false;\n\t\t\t}\n\t\t\treturn Object.keys(bar).length === len;\n\t\t}\n\t}\n\n\treturn foo !== foo && bar !== bar;\n}\n","import * as React from 'react'\nimport {dequal as deepEqual} from 'dequal'\n\ntype UseEffectParams = Parameters<typeof React.useEffect>\ntype EffectCallback = UseEffectParams[0]\ntype DependencyList = UseEffectParams[1]\n// yes, I know it's void, but I like what this communicates about\n// the intent of these functions: It's just like useEffect\ntype UseEffectReturn = ReturnType<typeof React.useEffect>\n\nfunction checkDeps(deps: DependencyList) {\n  if (!deps || !deps.length) {\n    throw new Error(\n      'useDeepCompareEffect should not be used with no dependencies. Use React.useEffect instead.',\n    )\n  }\n  if (deps.every(isPrimitive)) {\n    throw new Error(\n      'useDeepCompareEffect should not be used with dependencies that are all primitive values. Use React.useEffect instead.',\n    )\n  }\n}\n\nfunction isPrimitive(val: unknown) {\n  return val == null || /^[sbn]/.test(typeof val)\n}\n\nfunction useDeepCompareMemoize(value: DependencyList) {\n  const ref = React.useRef<DependencyList>()\n\n  if (!deepEqual(value, ref.current)) {\n    ref.current = value\n  }\n\n  return ref.current\n}\n\nfunction useDeepCompareEffect(\n  callback: EffectCallback,\n  dependencies: DependencyList,\n): UseEffectReturn {\n  if (process.env.NODE_ENV !== 'production') {\n    checkDeps(dependencies)\n  }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  React.useEffect(callback, useDeepCompareMemoize(dependencies))\n}\n\nexport function useDeepCompareEffectNoCheck(\n  callback: EffectCallback,\n  dependencies: DependencyList,\n): UseEffectReturn {\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  React.useEffect(callback, useDeepCompareMemoize(dependencies))\n}\n\nexport default useDeepCompareEffect\n"],"names":["has","Object","prototype","hasOwnProperty","find","iter","tar","key","keys","dequal","foo","bar","ctor","len","tmp","constructor","Date","getTime","RegExp","toString","Array","length","Set","size","Map","get","ArrayBuffer","Uint8Array","DataView","byteLength","getInt8","isView","call","checkDeps","deps","Error","every","isPrimitive","val","test","useDeepCompareMemoize","value","ref","React","useRef","deepEqual","current","useDeepCompareEffect","callback","dependencies","useEffect","useDeepCompareEffectNoCheck"],"mappings":"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"}